{% extends 'homepage.html' %}

{% block content %}


<!-- Hecke field and algebraic q-expansion data -->

<h2> {{KNOWL('mf.siegel.newspace',title='Newspace')}} parameters </h2>

<table>
  <tr>
    <td> {{ KNOWL('mf.siegel.family', title='Family') }}: </td>
    <td>{{ newform.family_str }}</td>
  </tr>
  <tr>
    <td> {{ KNOWL('mf.siegel.level', title='Level') }}: </td>
    <td> \( N \) </td>
    <td>\(=\)</td>
    <td>{{ newform.factored_level }}</td>
  </tr>
  <tr>
    <td> {{ KNOWL('mf.siegel.weight_k_j', title='Weight') }}: </td>
    <td> \( (k,j) \) </td>
    <td>\(=\)</td>
    <td>\( {{ newform.weight_str }} \)</td>
  </tr>
  <tr>
    <td> {{ KNOWL('character.dirichlet.galois_orbit_label', title='Character orbit') }}: </td>
    <td> \([\chi]\) </td>
    <td>\(=\)</td>
    <td> {{ newform.display_character() | safe }} </td>
  </tr>
</table>

<h2> Newform invariants </h2>

<table>
  <tr>
    <td>  {{ KNOWL('mf.siegel.automorphic_type', title='Automorphic type') }}: </td>
    <td>  {{newform.aut_type_str}} ({{newform.aut_rep_type }}) </td>
  </tr>

  <tr>
    <td> {{ KNOWL('mf.siegel.dimension', title='Dimension') }}: </td>
    <td>\({{ newform.dim }}\)</td>
  </tr>
  {% if newform.char_degree > 1 and newform.rel_dim > 1 %}
  <tr>
    <td> {{ KNOWL('mf.siegel.relative_dimension', title='Relative dimension') }}: </td>
    <td>\({{ newform.rel_dim }}\) over {{ newform.cyc_display() | safe }}</td>
  </tr>
  {% endif %}
  {% if newform.field_poly and newform.dim > 1 %}
  <!-- Coefficient code depends on existence of form -->
  <tr>
    <td> {{ KNOWL('mf.siegel.coefficient_field',title='Coefficient field') }}: </td>
    <td> {{ newform.field_display() | safe }}</td>
  </tr>
  <tr>
  	<td> {{ KNOWL('mf.siegel.defining_polynomial',title='Defining polynomial') }}: </td>
  	<td>{{ newform.field_poly_display | safe }}</td>
  </tr>
  {% if newform.hecke_ring_generator_nbound %}
  <tr>
    <td> {{ KNOWL('mf.siegel.coefficient_ring',title='Coefficient ring') }}: </td>
    <td> {{ newform.ring_display() | safe }}</td>
  </tr>
  {% endif %}
  {% elif newform.dim == 1 %}
  <tr>
    <td> {{ KNOWL('mf.siegel.coefficient_field',title='Coefficient field') }}: </td>
    <td> \(\mathbb{Q}\)</td>
  </tr>
  <tr>
    <td> {{ KNOWL('mf.siegel.coefficient_ring',title='Coefficient ring') }}: </td>
    <td> \(\mathbb{Z}\)</td>
  </tr>
  {% endif %}
  {% if newform.hecke_ring_index_factored %}
  <tr>
    <td> {{ KNOWL('mf.siegel.coefficient_ring',title='Coefficient ring index') }}: </td>
    <td> {{ newform.ring_index_display() | safe }}</td>
  </tr>
  {% endif %}
</table>

{% if newform.embedding_label %}

<h2> Embedding invariants </h2>

<table>
  <tr>
    <td>{{ KNOWL('mf.siegel.embedding_label', title='Embedding label') }}</td>
    <td></td>
    <td></td>
    <td> {{newform.embedding_label}}</td>
  </tr>
  {% if newform.embedding_root and newform.dim > 1 %}
  <tr>
    <td>{{ KNOWL('mf.siegel.root', title='Root') }}</td>
    <td></td>
    <td></td>
    <td>\({{newform.embedding_root}}\) of defining polynomial</td>
  </tr>
  {% endif %}
  <tr>
    <td>{{ KNOWL('mf.siegel.character', title='Character') }}</td>
    <td>\(\chi\)</td>
    <td>\(=\)</td>
    <td>{{ newform.char_conrey_link | safe}}</td>
  </tr>
{% if newform.embedding_label != newform.dual_label %}
  <tr>
    <td>{{ KNOWL('mf.siegel.dualform', 'Dual form') }}</td>
    <td></td>
    <td></td>
    <td> {{ newform.dual_link | safe }} </td>
  </tr>
{% endif %}
</table>
{% endif %}

{% if newform.char_order != 1 and (newform.dim <= 20 or newform.weight == 1 or newform.embedding_label) %}
<h2>Character values</h2>
<p>We give the values of \(\chi\) on generators for \(\left(\mathbb{Z}/{{newform.level}}\mathbb{Z}\right)^\times\).</p>
<table class="ntdata">
  <tbody>
    {{ newform.display_character_values() | safe }}
  </tbody>
</table>
{% endif %}

{% block subcontent %}
{% endblock %}

<script>
function show_qexp(qstyle) {
    $('.smalloutput').hide();
    $('.mediumoutput').hide();
    $('.'+qstyle).show();
    var elementBottom = $('#qexp-anchor').offset().top + $('#qexp-anchor').outerHeight();
    var viewportTop = $(window).scrollTop();
    return elementBottom < viewportTop;
  }
</script>
{% if newform.has_exact_qexp %}
<h2> {{ KNOWL('mf.siegel.q-expansion',title='$q$-expansion')}}</h2>
<div id="qexp-div">
  <form id="qexp">
    <table class="qexp-table">
      <tr>
        <td class="fdef">\(f(q)\)</td>
        <td class="op">\(=\)</td>
        <td class="qexp-output smalloutput">{{ newform.q_exp_short(prec_max=4) }}</td>
        <td class="qexp-output mediumoutput nodisplay">{{ newform.q_exp_short(prec_max=8) }}</td>
      </tr>
      {% if newform.dim > 1 %}
      <tr>
        <td class="topspace fdef">\(\operatorname{Tr}(f)(q)\)</td>
        <td class="op topspace">\(=\)</td>
        <td class="qexp-output topspace smalloutput">{{ newform.trace_expansion(prec_max=4) | safe }}</td>
        <td class="qexp-output topspace mediumoutput nodisplay">{{ newform.trace_expansion(prec_max=8) | safe }}</td>
      </tr>
      {% endif %}
    </table>

    <p>
      <div class="toggle" style="padding-left:9px;">Display full $q$-expansion up to
        <span class='smalloutput'><a onclick="show_qexp('mediumoutput'); return false;" href='#'>degree 8</a></span>
        <span class='mediumoutput nodisplay'><a onclick="return show_qexp('smalloutput');" href='#qexp-anchor'>degree 4</a></span>
      </div>
    </p>
  </form>
</div>

<p> Below is a table of coefficients indexed by {{ KNOWL('mf.siegel.reduced_quadratic_form', title='reduced quadratic forms') }}: </p>

<p> For more coefficients, see the Downloads table to the right. </p>

<form><p> Input a triple of integers $(n_1,n_{12},n_2)$ to see the associated coefficient:
    <label for="coeff"></label> <input type="text" id="coeff">
    <button title="Coefficient" onclick="fourier_coefficient('{{newform.label}}', $('#coeff').val(), cur_lang); return false;">submit</button></p></form>

{% else %}
{% if newform.has_exact_lfunc or (newform.embedding_label and newform.has_complex_qexp) %}

<h2 id="qexp-anchor"> {{ KNOWL('lfunction.dirichlet_series',title='Dirichlet series')}}</h2>
<div id="qexp-div">
  {% if newform.dim > 1  and not newform.embedding_label %}
    <p>
      {% if not newform.hecke_ring_cyclotomic_generator %}
      Coefficients of the Dirichlet series are expressed in terms of {{ newform.order_gen() | safe }}.
      We also show the integral Dirichlet series of the {{ KNOWL('mf.siegel.trace_form',title='trace form') }}.
      {% else %}
      The Dirichlet series and {{ KNOWL('mf.siegel.trace_form',title='trace form') }} are shown below.
      {% endif %}
    </p>
  {% endif %}
  <form id="qexp">
    <table class="qexp-table">
      <tr>
        <td class="fdef">\(L_{\rm spin}(f,s)\)</td>
        <td class="op">\(=\)</td>
        <td class="qexp-output smalloutput">{{ newform.L_function(prec_max=10) | safe }}</td>
        <td class="qexp-output mediumoutput nodisplay">{{ newform.L_function(prec_max=100) | safe }}</td>
      </tr>
      {% if newform.dim > 1 %}
      <tr>
        <td class="topspace fdef">\(L_{\rm spin}(\operatorname{Tr}(f),s)\)</td>
        <td class="op topspace">\(=\)</td>
        <td class="qexp-output topspace smalloutput">{{ newform.trace_lfunction(prec_max=10) | safe }}</td>
        <td class="qexp-output topspace mediumoutput nodisplay">{{ newform.trace_lfunction(prec_max=100) | safe }}</td>
      </tr>
      {% endif %}
    </table>

    <p>
      <div class="toggle" style="padding-left:9px;">Display
        <span class='smalloutput'><a onclick="show_qexp('mediumoutput'); return false;" href='#'>100 coefficients</a></span>
        <span class='mediumoutput nodisplay'><a onclick="return show_qexp('smalloutput');" href='#qexp-anchor'>10 coefficients</a></span>
      </div>
    </p>
  </form>

  {% if newform.show_hecke_ring_basis %}
    <p> Basis of {{ KNOWL('mf.siegel.coefficient_ring',title='coefficient ring') }}{{ newform.order_gen_below() | safe }}</p>
    {{ newform.order_basis() | safe}}
  {% endif %}
</div>
{% else %}
<h2 id="qexp-anchor"> {{ KNOWL('lfunction.dirichlet_series',title='Dirichlet series')}}</h2>
<p>The dimension is sufficiently large that we do not compute the $L$-series, but we have computed the trace of the $L$-series.</p>

<form id="qexp">
  <table><tr><td>
  <div class="smalloutput">
    <span>\(L_{\rm spin}(\operatorname{Tr}(f),s)\) =  {{ newform.trace_expansion(prec_max=10) | safe }}</span>
  </div>
  <div class="mediumoutput nodisplay">
    <span>\(L_{\rm spin}(\operatorname{Tr}(f),s)\) = {{ newform.trace_expansion(prec_max=100) | safe }}</span>
  </div></td></tr></table>

  <p style="padding-left: 1ch;">
    <div class="toggle">Display
      <span class='smalloutput'><a onclick="show_qexp('mediumoutput'); return false" href='#'>100 coefficients</a></span>
      <span class='mediumoutput nodisplay'><a onclick="show_qexp('smalloutput'); return false" href='#'>10 coefficients</a></span>
    </div>
  </p>
</form>
{% endif %}
{% endif %}

{% if newform.has_exact_lfunc %}
<h2>Hecke eigenvalues</h2>
<div class="table-scroll-wrapper">
<table class="ntdata complex-cols">
  <thead>
    <tr>
      <th class="sticky-head dark" style="min-width: 40px;">Hecke operator</th>
      {% for n in newform.primes %}
      <th class="center dark" colspan="1">\( {{ newform.hecke_ev_header(n) }} \)</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% set headcol_rowspan = 1 %}
    {% for ht in newform.hecke_types %}
    {% if loop.index is divisibleby(2) %}
    {% set shade = 'dark' %}
    {% else %}
    {% set shade = 'light' %}
    {% endif %}
    <tr>
      {% set hd = newform.hecke_disp[ht] %}
      <td rowspan="{{headcol_rowspan}}" class="{{shade}} sticky-col border-right" style="min-width: 40px;" align="center">
	\( T_{ {{ hd }} } \)
      </td>
      {% for n in newform.range_evs %}
      <td align="right">
        {{ newform.hecke_eigenvalue(ht,n) | safe }}
      </td>
      {% endfor %} {# n loop #}
    </tr>
    {% endfor %} {# ht loop #}
    <tr style="max-height: 0px;" class="border-bottom"> {# Add a bottom border #}
      <td style="max-height: 0px;margin: 0px;padding: 0px;" colspan="{{2 + (info.CC_n | length)}}"></td>
    </tr>
  </tbody>
</table>
</div>
{% endif %}

{% if newform.char_orbit_index == 1 and newform.atkin_lehner_eigenvals %}
<h2>{{KNOWL('mf.siegel.atkin-lehner', title='Atkin-Lehner signs')}}</h2>
<table class="ntdata">
  <thead>
    <tr>
      <th class="center"> \( p \) </th>
      <th class="center">Sign
    </tr>
  </thead>
  <tbody>
    {% for p, ev in newform.atkin_lehner_eigenvals %}
    <tr>
      <td class="center"> \({{ p }}\) </td>
      <td class="center"> \({{ ev }}\)</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}


<h2>Fourier coefficients</h2>
<div>
<table class="ntdata">
  <thead>
    <tr>
      <th>Discriminant</th>
      <th>Quadratic form</th>
      <th>Coefficient</th>
    </tr>
  </thead>
  <tbody>
  {% set data = newform.q_exp_coefficients(50) %}
  {% set less_num = 8 %}
  {% for q, val in data %}
  {% if loop.index <= less_num %}
    <tr>
  {% else %}
    <tr class="more nodisplay">
  {% endif %}
      <td align="center"> \( {{ q[1]**2-4*q[0]*q[2] }} \) </td>
      <td align="center"> \( {{ q }} \) </td>
      <td align="center"> \( {{ val }} \) </td>
    </tr>
    {% endfor %}
    <tr class="less toggle">
    <td>
      <a onclick="show_moreless(&quot;more&quot;)" href="#moreep">
        show more</a>
    </td>
    </tr>
    <tr class="more toggle nodisplay">
      <td>
        <a onclick="show_moreless(&quot;less&quot;)" href="#eptable">
          show less</a>
      </td>
    </tr>
  </tbody>
</table>
</div>

{% endblock %}
